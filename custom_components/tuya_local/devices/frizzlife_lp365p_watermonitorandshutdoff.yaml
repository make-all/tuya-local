name: Smart Water Meter
products:
  - id: 89tojzdfimssmkuk
    manufacturer: Frizzlife
    model: LP365P
entities:
  # Valve
  - entity: valve
    class: water
    dps:
      - id: 1
        type: boolean
        name: valve

  # Temperature sensor (converted to F)
  - entity: sensor
    class: temperature
    dps:
      - id: 12
        type: integer
        name: sensor
        unit: Â°C
        class: measurement
        mapping:
          - scale: 10.0
        range:
          min: 0
          max: 220

  # Protection Enabled Switch
  - entity: switch
    name: Protection Enabled
    dps:
      - id: 101
        type: boolean
        name: switch

  # Volume Today (Total, in gallons)
  - entity: sensor
    name: Volume Today
    class: water
    dps:
      - id: 103
        type: integer
        optional: true
        name: sensor
        class: total_increasing
        unit: gal
        mapping:
          - scale: 10.0
            transform: value / 3.785

  # Flow Rate per Minute (in gal/min)
  - entity: sensor
    class: volume_flow_rate
    name: Flow Rate per Minute
    dps:
      - id: 104
        type: integer
        optional: true
        name: sensor
        class: measurement
        unit: gal/min
        mapping:
          - scale: 1
            # Device gives L/h, convert to gal/min
            transform: (value / 3.785) / 60

  # Current Flow Rate (in gal/min)
  - entity: sensor
    class: volume_flow_rate
    name: Current Flow Rate
    dps:
      - id: 105
        type: integer
        name: sensor
        class: measurement
        unit: gal/min
        mapping:
          - scale: 1000.0
            transform: (value / 3.785) / 60

  # Leak Warning
  - entity: sensor
    name: Leak Warning
    dps:
      - id: 106
        type: boolean
        name: sensor

  # Leak Alarm
  - entity: sensor
    name: Leak Alarm
    dps:
      - id: 107
        type: boolean
        name: sensor

  # Alarm Clear Button
  - entity: button
    name: Alarm Clear
    dps:
      - id: 108
        type: boolean
        name: button

  # Protection Mode Select
  - entity: select
    name: Protection Mode
    category: config
    dps:
      - id: 109
        type: string
        name: option
        mapping:
          - dps_val: "AUTO"
            value: "Auto"
          - dps-val: "ADVANCED_SETTING"
            value: "Advanced"

  # AUTO Mode #
  - entity: select
    name: "AUTO Mode #"
    category: config
    dps:
      - id: 110
        type: string
        name: option
        mapping:
          - dps_val: "mode1"
            value: "Mode 1"
          - dps_val: "mode2"
            value: "Mode 2"
          - dps_val: "mode3"
            value: "Mode 3"

  # ADVANCED Mode #
  - entity: select
    name: "ADVANCED Mode #"
    category: config
    dps:
      - id: 111
        type: string
        name: option
        mapping:
          - dps_val: "mode4"
            value: "Mode 4"
          - dps_val: "mode5"
            value: "Mode 5"
          - dps_val: "mode6"
            value: "Mode 6"

  # Mode4 Allowed Flow Time (hr)
  - entity: select
    name: Mode4 Allowed Flow Time
    category: config
    dps:
      - id: 112
        type: integer
        unit: hr
        name: option
        mapping:
          # unchanged (same mapping as before)
          - dps_val: 3
            value: "0.3"
          - dps_val: 4
            value: "0.4"
          - dps_val: 5
            value: "0.5"
          - dps_val: 6
            value: "0.6"
          - dps_val: 7
            value: "0.7"
          - dps_val: 8
            value: "0.8"
          - dps_val: 9
            value: "0.9"
          - dps_val: 10
            value: "1.0"
          - dps_val: 11
            value: "1.1"
          - dps_val: 12
            value: "1.2"
          - dps_val: 13
            value: "1.3"
          - dps_val: 14
            value: "1.4"
          - dps_val: 15
            value: "1.5"
          - dps_val: 16
            value: "1.6"
          - dps_val: 17
            value: "1.7"
          - dps_val: 18
            value: "1.8"
          - dps_val: 19
            value: "1.9"
          - dps_val: 20
            value: "2.0"
          - dps_val: 21
            value: "2.1"
          - dps_val: 22
            value: "2.2"
          - dps_val: 23
            value: "2.3"
          - dps_val: 24
            value: "2.4"
          - dps_val: 25
            value: "2.5"
          - dps_val: 26
            value: "2.6"
          - dps_val: 27
            value: "2.7"
          - dps_val: 28
            value: "2.8"
          - dps_val: 29
            value: "2.9"
          - dps_val: 30
            value: "3.0"

  # Mode4 Allowed Flow Volume (gal)
  - entity: select
    name: Mode4 Allowed Flow Volume
    category: config
    dps:
      - id: 115
        type: integer
        unit: gal
        name: option
        mapping:
          - dps_val: 0
            value: "13" # 50 L
          - dps_val: 1
            value: "26" # 100 L
          - dps_val: 2
            value: "53" # 200 L
          - dps_val: 3
            value: "79" # 300 L
          - dps_val: 4
            value: "106" # 400 L
          - dps_val: 5
            value: "132" # 500 L
          - dps_val: 6
            value: "158" # 600 L
          - dps_val: 7
            value: "185" # 700 L
          - dps_val: 8
            value: "211" # 800 L
          - dps_val: 9
            value: "238" # 900 L
          - dps_val: 10
            value: "264" # 1000 L
          - dps_val: 11
            value: "291" # 1100 L
          - dps_val: 12
            value: "317" # 1200 L
          - dps_val: 13
            value: "343" # 1300 L
          - dps_val: 14
            value: "370" # 1400 L
          - dps_val: 15
            value: "396" # 1500 L
          - dps_val: 16
            value: "423" # 1600 L
          - dps_val: 17
            value: "449" # 1700 L
          - dps_val: 18
            value: "476" # 1800 L
          - dps_val: 19
            value: "502" # 1900 L
          - dps_val: 20
            value: "528" # 2000 L
          - dps_val: 25
            value: "660" # 2500 L
          - dps_val: 30
            value: "793" # 3000 L
          - dps_val: 35
            value: "925" # 3500 L
          - dps_val: 40
            value: "1058" # 4000 L
          - dps_val: 45
            value: "1191" # 4500 L
          - dps_val: 50
            value: "1321" # 5000 L

  # Mode5 Allowed Flow Time (hr)
  - entity: select
    name: Mode5 Allowed Flow Time
    category: config
    dps:
      - id: 113
        type: integer
        unit: hr
        name: option
        mapping:
          # unchanged
          - dps_val: 3
            value: "0.3"
          - dps_val: 4
            value: "0.4"
          - dps_val: 5
            value: "0.5"
          - dps_val: 6
            value: "0.6"
          - dps_val: 7
            value: "0.7"
          - dps_val: 8
            value: "0.8"
          - dps_val: 9
            value: "0.9"
          - dps_val: 10
            value: "1.0"
          - dps_val: 11
            value: "1.1"
          - dps_val: 12
            value: "1.2"
          - dps_val: 13
            value: "1.3"
          - dps_val: 14
            value: "1.4"
          - dps_val: 15
            value: "1.5"
          - dps_val: 16
            value: "1.6"
          - dps_val: 17
            value: "1.7"
          - dps_val: 18
            value: "1.8"
          - dps_val: 19
            value: "1.9"
          - dps_val: 20
            value: "2.0"
          - dps_val: 21
            value: "2.1"
          - dps_val: 22
            value: "2.2"
          - dps_val: 23
            value: "2.3"
          - dps_val: 24
            value: "2.4"
          - dps_val: 25
            value: "2.5"
          - dps_val: 26
            value: "2.6"
          - dps_val: 27
            value: "2.7"
          - dps_val: 28
            value: "2.8"
          - dps_val: 29
            value: "2.9"
          - dps_val: 30

  # Mode5 Allowed Flow Volume (gal)
  - entity: select
    name: Mode5 Allowed Flow Volume
    category: config
    dps:
      - id: 116
        type: integer
        unit: gal
        name: option
        mapping:
          - dps_val: 0
            value: "13"
          - dps_val: 1
            value: "26"
          - dps_val: 2
            value: "53"
          - dps_val: 3
            value: "79"
          - dps_val: 4
            value: "106"
          - dps_val: 5
            value: "132"
          - dps_val: 6
            value: "158"
          - dps_val: 7
            value: "185"
          - dps_val: 8
            value: "211"
          - dps_val: 9
            value: "238"
          - dps_val: 10
            value: "264"
          - dps_val: 11
            value: "291"
          - dps_val: 12
            value: "317"
          - dps_val: 13
            value: "343"
          - dps_val: 14
            value: "370"
          - dps_val: 15
            value: "396"
          - dps_val: 16
            value: "423"
          - dps_val: 17
            value: "449"
          - dps_val: 18
            value: "476"
          - dps_val: 19
            value: "502"
          - dps_val: 20
            value: "528"
          - dps_val: 25
            value: "660"
          - dps_val: 30
            value: "793"
          - dps_val: 35
            value: "925"
          - dps_val: 40
            value: "1058"
          - dps_val: 45
            value: "1191"
          - dps_val: 50
            value: "1321"

  # Mode6 Allowed Flow Time (hr)
  - entity: select
    name: Mode6 Allowed Flow Time
    category: config
    dps:
      - id: 114
        type: integer
        unit: hr
        name: option
        mapping:
          # unchanged
          - dps_val: 3
            value: "0.3"
          - dps_val: 4
            value: "0.4"
          - dps_val: 5
            value: "0.5"
          - dps_val: 6
            value: "0.6"
          - dps_val: 7
            value: "0.7"
          - dps_val: 8
            value: "0.8"
          - dps_val: 9
            value: "0.9"
          - dps_val: 10
            value: "1.0"
          - dps_val: 11
            value: "1.1"
          - dps_val: 12
            value: "1.2"
          - dps_val: 13
            value: "1.3"
          - dps_val: 14
            value: "1.4"
          - dps_val: 15
            value: "1.5"
          - dps_val: 16
            value: "1.6"
          - dps_val: 17
            value: "1.7"
          - dps_val: 18
            value: "1.8"
          - dps_val: 19
            value: "1.9"
          - dps_val: 20
            value: "2.0"
          - dps_val: 21
            value: "2.1"
          - dps_val: 22
            value: "2.2"
          - dps_val: 23
            value: "2.3"
          - dps_val: 24
            value: "2.4"
          - dps_val: 25
            value: "2.5"
          - dps_val: 26
            value: "2.6"
          - dps_val: 27
            value: "2.7"
          - dps_val: 28
            value: "2.8"
          - dps_val: 29
            value: "2.9"
          - dps_val: 30

  # Mode6 Allowed Flow Volume (gal)
  - entity: select
    name: Mode6 Allowed Flow Volume
    category: config
    dps:
      - id: 117
        type: integer
        unit: gal
        name: option
        mapping:
          - dps_val: 0
            value: "13"
          - dps_val: 1
            value: "26"
          - dps_val: 2
            value: "53"
          - dps_val: 3
            value: "79"
          - dps_val: 4
            value: "106"
          - dps_val: 5
            value: "132"
          - dps_val: 6
            value: "158"
          - dps_val: 7
            value: "185"
          - dps_val: 8
            value: "211"
          - dps_val: 9
            value: "238"
          - dps_val: 10
            value: "264"
          - dps_val: 11
            value: "291"
          - dps_val: 12
            value: "317"
          - dps_val: 13
            value: "343"
          - dps_val: 14
            value: "370"
          - dps_val: 15
            value: "396"
          - dps_val: 16
            value: "423"
          - dps_val: 17
            value: "449"
          - dps_val: 18
            value: "476"
          - dps_val: 19
            value: "502"
          - dps_val: 20
            value: "528"
          - dps_val: 25
            value: "660"
